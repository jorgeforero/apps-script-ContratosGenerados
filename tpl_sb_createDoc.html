<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

  <style>
    body {
      display: flex;
      min-height: 100vh;
      flex-direction: column;
      background-color: #F5F5F5;
    }
    main {
      flex: 1 0 auto;
    }
  </style>

</head>

<body>
  <!-- Main Container -->
  <div class="container">

    <!-- form -->
    <div class="row">
        <div class="col s12">
         &nbsp;
        </div>  
    </div>

    <div class="row">
        <div class="col s12">
         Genera el documento de contrato de uso de la plataforma de la Empresa
        </div>

        <div class="input-field col s12 center-align">
          <button class="btn waves-effect waves-light" type="submit" id="action">Generar Contrato<i class="material-icons left">arrow_back</i></button>
        </div>
        
        <div class="col s12">
          <div class="card-panel">
            <div id="preresult">                                        
            </div>
          </div>
        </div>
        
        <div class="col s12">
         &nbsp;
        </div>
                
    </div>
    <!-- /form -->

  </div>
  <!-- main container -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <!-- ** Materialize ** -->
  

  <!-- ** JS Validations ** -->
  <script>
    // Asigna los click handlers a cada bot√≥n de la forma
    $(function() {
      $('#action').click( getDoc );
    });
    
  </script>

  <!-- ** Backend Calls ** -->
  <script>
  
    // get the pre-invoice
    function getDoc() {    
      $('#preresult').html( spinner() );
      
      M.toast({
        html: 'Generando documento'
      });
      google.script.run
        .withSuccessHandler(
          function getResult(msg) {
            M.toast({
              html: msg
            });
            
            $('#preresult').html(msg);
            
          })
        .withUserObject(this)
        .populateDoc();
     }
     
     // Display the spinner
     function spinner() {
       return '<!-- loader -->'
              + '<div class="preloader-wrapper small active">'
              + '<div class="spinner-layer spinner-blue-only">'
              + '<div class="circle-clipper left">'
              + '<div class="circle"></div>'
              + '</div>'
              + '<div class="gap-patch">'
              + '<div class="circle"></div>'
              + '</div>'
              + '<div class="circle-clipper right">'
              + '<div class="circle"></div>'
              + '</div>'
              + '</div>'
              + '</div>';
     }

  </script>
</body>
</html>
